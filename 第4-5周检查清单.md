# 第4-5周检查清单

## 第四周 - 健康数据记录（其他指标）

### 后端实现
- [x] BloodGlucose 实体类
- [x] BloodGlucoseMapper 接口
- [x] BloodGlucoseService 服务
- [x] BloodGlucoseController 控制器
- [x] Exercise 实体类
- [x] ExerciseMapper 接口
- [x] ExerciseService 服务
- [x] ExerciseController 控制器
- [x] Sleep 实体类
- [x] SleepMapper 接口
- [x] SleepService 服务
- [x] SleepController 控制器
- [x] Diet 实体类
- [x] DietMapper 接口
- [x] DietService 服务
- [x] DietController 控制器
- [x] MentalHealth 实体类
- [x] MentalHealthMapper 接口
- [x] MentalHealthService 服务
- [x] MentalHealthController 控制器

### 前端实现
- [x] health.js API 更新（添加5个数据类型的API方法）
- [x] GlucoseRecord.vue 页面
- [x] ExerciseRecord.vue 页面
- [x] SleepRecord.vue 页面
- [x] DietRecord.vue 页面
- [x] MentalHealthRecord.vue 页面
- [x] 路由配置更新（添加5个新路由）
- [x] Layout.vue 菜单更新（启用新菜单项）

### 功能验证
- [ ] 血糖记录：添加、编辑、删除、列表查询、日期过滤、分页
- [ ] 运动记录：添加、编辑、删除、列表查询、日期过滤、分页
- [ ] 睡眠记录：添加、编辑、删除、列表查询、日期过滤、分页
- [ ] 饮食记录：添加、编辑、删除、列表查询、日期过滤、分页
- [ ] 心理健康：添加、编辑、删除、列表查询、日期过滤、分页

---

## 第五周 - 仪表板与数据概览

### 后端实现
- [x] AnalysisService 数据统计服务
  - [x] getLatestData() - 获取最新数据
  - [x] getTodaySummary() - 获取今日统计
  - [x] getWeeklySummary() - 获取周统计
  - [x] getMonthlySummary() - 获取月统计
- [x] AnalysisController 数据分析接口
  - [x] GET /api/analysis/latest
  - [x] GET /api/analysis/today-summary
  - [x] GET /api/analysis/weekly-summary
  - [x] GET /api/analysis/monthly-summary

### 前端实现
- [x] analysis.js API 模块
- [x] Dashboard.vue 仪表板页面
  - [x] 快捷卡片区（4卡片）
  - [x] 数据概览区（3卡片）
  - [x] 周统计信息
  - [x] 月统计信息
  - [x] 快速操作按钮（6个）
- [x] 路由配置更新（dashboard 路由指向新页面）

### 功能验证
- [ ] 仪表板页面加载
- [ ] 快捷卡片显示数据：
  - [ ] 今日摄入卡路里
  - [ ] 今日运动卡路里
  - [ ] 睡眠时长
  - [ ] 今日步数
- [ ] 数据概览显示：
  - [ ] 最新体重及体脂率
  - [ ] 最新血压及状态
  - [ ] 最新血糖及测量类型
- [ ] 周统计显示：
  - [ ] 周运动卡路里
  - [ ] 周平均睡眠
- [ ] 月统计显示：
  - [ ] 体重变化
  - [ ] 平均血压
- [ ] 快速操作：
  - [ ] 所有6个按钮能正确跳转到对应页面

---

## 数据库表创建

需要创建以下表（如尚未创建）：

```sql
-- 血糖记录表
CREATE TABLE blood_glucose_records (
  id BIGINT PRIMARY KEY AUTO_INCREMENT,
  user_id BIGINT NOT NULL,
  glucose_value DECIMAL(5,2) NOT NULL,
  measurement_type VARCHAR(50),
  record_date DATE NOT NULL,
  record_time VARCHAR(10),
  notes TEXT,
  create_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  update_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  KEY idx_user_date (user_id, record_date)
) CHARSET=utf8mb4;

-- 运动记录表
CREATE TABLE exercise_records (
  id BIGINT PRIMARY KEY AUTO_INCREMENT,
  user_id BIGINT NOT NULL,
  exercise_type VARCHAR(50) NOT NULL,
  duration INT,
  intensity VARCHAR(20),
  calories_burned DECIMAL(8,2),
  record_date DATE NOT NULL,
  record_time VARCHAR(10),
  notes TEXT,
  create_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  update_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  KEY idx_user_date (user_id, record_date)
) CHARSET=utf8mb4;

-- 睡眠记录表
CREATE TABLE sleep_records (
  id BIGINT PRIMARY KEY AUTO_INCREMENT,
  user_id BIGINT NOT NULL,
  bed_time VARCHAR(10),
  wake_time VARCHAR(10),
  sleep_duration DECIMAL(4,2),
  sleep_quality INT,
  record_date DATE NOT NULL,
  notes TEXT,
  create_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  update_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  KEY idx_user_date (user_id, record_date)
) CHARSET=utf8mb4;

-- 饮食记录表
CREATE TABLE diet_records (
  id BIGINT PRIMARY KEY AUTO_INCREMENT,
  user_id BIGINT NOT NULL,
  food_name VARCHAR(100) NOT NULL,
  category VARCHAR(50),
  quantity VARCHAR(50),
  calories DECIMAL(8,2),
  protein DECIMAL(8,2),
  fat DECIMAL(8,2),
  carbohydrates DECIMAL(8,2),
  record_date DATE NOT NULL,
  record_time VARCHAR(10),
  notes TEXT,
  create_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  update_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  KEY idx_user_date (user_id, record_date)
) CHARSET=utf8mb4;

-- 心理健康记录表
CREATE TABLE mental_health_records (
  id BIGINT PRIMARY KEY AUTO_INCREMENT,
  user_id BIGINT NOT NULL,
  mood_score INT,
  stress_level VARCHAR(20),
  anxiety_level INT,
  mentals_state VARCHAR(50),
  record_date DATE NOT NULL,
  record_time VARCHAR(10),
  notes TEXT,
  create_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  update_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  KEY idx_user_date (user_id, record_date)
) CHARSET=utf8mb4;
```

---

## API 端点总结

### 血糖管理
- POST `/api/health/blood-glucose` - 添加
- GET `/api/health/blood-glucose` - 查询列表
- PUT `/api/health/blood-glucose/{id}` - 更新
- DELETE `/api/health/blood-glucose/{id}` - 删除

### 运动管理
- POST `/api/health/exercise` - 添加
- GET `/api/health/exercise` - 查询列表
- PUT `/api/health/exercise/{id}` - 更新
- DELETE `/api/health/exercise/{id}` - 删除

### 睡眠管理
- POST `/api/health/sleep` - 添加
- GET `/api/health/sleep` - 查询列表
- PUT `/api/health/sleep/{id}` - 更新
- DELETE `/api/health/sleep/{id}` - 删除

### 饮食管理
- POST `/api/health/diet` - 添加
- GET `/api/health/diet` - 查询列表
- PUT `/api/health/diet/{id}` - 更新
- DELETE `/api/health/diet/{id}` - 删除

### 心理健康管理
- POST `/api/health/mental-health` - 添加
- GET `/api/health/mental-health` - 查询列表
- PUT `/api/health/mental-health/{id}` - 更新
- DELETE `/api/health/mental-health/{id}` - 删除

### 数据分析
- GET `/api/analysis/latest` - 获取最新数据
- GET `/api/analysis/today-summary` - 获取今日统计
- GET `/api/analysis/weekly-summary` - 获取周统计
- GET `/api/analysis/monthly-summary` - 获取月统计

---

## 页面路由

### 菜单导航（在Layout中）
- `/layout/dashboard` - 仪表板
- 数据记录 (菜单组)
  - `/layout/weight-record` - 体重
  - `/layout/blood-pressure-record` - 血压
  - `/layout/glucose-record` - 血糖
  - `/layout/exercise-record` - 运动
  - `/layout/sleep-record` - 睡眠
  - `/layout/diet-record` - 饮食
  - `/layout/mental-health-record` - 心理健康
  - `/layout/settings` - 设置

---

## 已知问题与优化空间

### 需要改进的地方
1. **数据库查询优化** - 当数据量很大时，应添加更多索引
2. **缓存策略** - 分析接口可以考虑缓存以提高性能
3. **图表可视化** - Dashboard 目前只显示数据，后续应集成 ECharts
4. **数据导出** - 目前还没有实现数据导出功能
5. **实时推送** - 告警和提醒功能还未实现

### 性能优化建议
1. 使用分页避免一次加载过多数据
2. 对频繁查询的结果进行缓存
3. 为 user_id 和 record_date 字段添加复合索引
4. 考虑分表分库策略应对大数据量

---

## 测试建议

### 单元测试
- Service 层的数据验证逻辑
- Controller 层的参数解析和响应格式

### 集成测试
- 前后端 API 联通
- 数据持久化到数据库
- 日期范围查询的准确性

### 功能测试
- 完整的 CRUD 操作流程
- 边界条件（如无数据情况）
- 用户隔离（不同用户看不到彼此的数据）

### 性能测试
- 大数据量下的查询性能
- 分页查询的速度
- 分析接口的响应时间

